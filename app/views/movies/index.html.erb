<% content_for :title, t('movies.title') %>

<div class="container-fluid">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h1><i class="fas fa-film"></i> <%= t('movies.title') %></h1>
    <% if user_signed_in? %>
      <%= link_to t('movies.new'), new_movie_path, class: "btn btn-primary" %>
    <% end %>
  </div>

  <div class="card mb-4">
    <div class="card-body">
      <%= form_with url: search_movies_path, method: :get, local: true, class: "row g-3" do |f| %>
        <div class="col-md-4 col-lg-3">
          <%= f.text_field :q, placeholder: t('movies.search_placeholder'), 
                          value: params[:q], class: "form-control" %>
        </div>
        <div class="col-md-3 col-lg-2">
          <%= f.select :category_id, 
                      options_from_collection_for_select(@categories, :id, :name, params[:category_id]),
                      { prompt: t('movies.all_categories') }, 
                      { class: "form-select" } %>
        </div>
        <div class="col-md-3 col-lg-2">
          <%= f.number_field :year, placeholder: t('movies.year'), 
                            value: params[:year], class: "form-control" %>
        </div>
        <div class="col-md-2">
          <%= f.submit t('movies.search'), class: "btn btn-outline-primary w-100" %>
        </div>
      <% end %>
    </div>
  </div>

  <% if @movies.any? %>
    <div class="row">
      <% @movies.each do |movie| %>
        <div class="col-sm-6 col-md-3 mb-4">
          <%= render 'movie_card', movie: movie %>
        </div>
      <% end %>
    </div>

    <div class="d-flex justify-content-center">
      <%= paginate @movies %>
    </div>
  <% else %>
    <div class="text-center py-5">
      <i class="fas fa-film fa-3x text-muted mb-3"></i>
      <h3 class="text-muted"><%= t('movies.no_movies_found') %></h3>
      <% if user_signed_in? %>
        <p class="text-muted"><%= t('movies.be_first_to_add') %></p>
        <%= link_to t('movies.new'), new_movie_path, class: "btn btn-primary" %>
      <% else %>
        <p class="text-muted"><%= t('movies.login_to_add') %></p>
        <%= link_to t('nav.login'), new_user_session_path, class: "btn btn-outline-primary" %>
      <% end %>
    </div>
  <% end %>
</div>